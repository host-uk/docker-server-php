; ============================================================
; PHP Production Configuration
; Security and performance hardened settings
; ============================================================

[PHP]
; Error handling - never display to users
display_errors = Off
display_startup_errors = Off
error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT
log_errors = On
error_log = /dev/stderr
html_errors = Off

; Hide PHP version
expose_php = Off

; Resource limits
max_execution_time = ${PHP_MAX_EXECUTION_TIME:-30}
max_input_time = ${PHP_MAX_INPUT_TIME:-60}
memory_limit = ${PHP_MEMORY_LIMIT:-256M}
max_input_vars = ${PHP_MAX_INPUT_VARS:-1000}

; Upload limits
upload_max_filesize = ${PHP_UPLOAD_MAX_FILESIZE:-64M}
post_max_size = ${PHP_POST_MAX_SIZE:-64M}

; Realpath cache - maximize for production
realpath_cache_size = 4096K
realpath_cache_ttl = 600

; Disable dangerous functions
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,parse_ini_file,show_source,pcntl_exec

; Security settings
allow_url_fopen = Off
allow_url_include = Off
register_argc_argv = Off

; Session security
session.use_strict_mode = 1
session.use_only_cookies = 1
session.cookie_httponly = 1
session.cookie_secure = ${PHP_SESSION_COOKIE_SECURE:-1}
session.cookie_samesite = Lax
session.use_trans_sid = 0
session.gc_probability = 1
session.gc_divisor = 1000
session.gc_maxlifetime = 1440

; Assertions disabled in production
zend.assertions = -1

; Output buffering
output_buffering = 4096
implicit_flush = Off

[Date]
date.timezone = ${PHP_TIMEZONE:-UTC}

[mysqlnd]
; Disable memory statistics in production
mysqlnd.collect_memory_statistics = Off

[mail]
; Force mail to use configured sender
mail.add_x_header = Off
