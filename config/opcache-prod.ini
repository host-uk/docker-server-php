; ============================================================
; OPcache Production Configuration
; Maximum performance settings for production
; ============================================================

[opcache]
; Enable OPcache
opcache.enable = 1
opcache.enable_cli = 1

; Memory settings (adjust based on application size)
; Recommended: 128-256MB for most applications
opcache.memory_consumption = ${PHP_OPCACHE_MEMORY:-256}

; Interned strings buffer (for class names, function names, etc.)
opcache.interned_strings_buffer = ${PHP_OPCACHE_STRINGS:-16}

; Maximum number of scripts to cache
; Use a prime number for optimal hashing
opcache.max_accelerated_files = ${PHP_OPCACHE_FILES:-20011}

; PRODUCTION: Disable timestamp validation for maximum performance
; Scripts will only be reloaded on server restart
opcache.validate_timestamps = 0
opcache.revalidate_freq = 0

; File cache for persistence across restarts
opcache.file_cache = /tmp/opcache
opcache.file_cache_only = 0
opcache.file_cache_consistency_checks = 0

; Optimization settings
opcache.optimization_level = 0x7FFEBFFF
opcache.save_comments = 1
opcache.fast_shutdown = 1

; Huge pages support (if available on host)
opcache.huge_code_pages = 1

; JIT compilation (PHP 8.0+)
; tracing: Best for long-running scripts
; function: Best for short scripts
opcache.jit = tracing
opcache.jit_buffer_size = ${PHP_OPCACHE_JIT_BUFFER:-128M}

; Preloading (set path in your application)
; opcache.preload = /var/www/html/preload.php
; opcache.preload_user = nobody

; Error logging
opcache.log_verbosity_level = 1
opcache.error_log = /dev/stderr
