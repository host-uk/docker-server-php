# ============================================================
# Docker Server PHP - Environment Configuration
# ============================================================

# ============================================================
# PHP Configuration
# ============================================================

# Timezone (https://www.php.net/manual/en/timezones.php)
PHP_TIMEZONE=UTC

# Memory and limits
PHP_MEMORY_LIMIT=256M
PHP_UPLOAD_MAX_FILESIZE=64M
PHP_POST_MAX_SIZE=64M
PHP_MAX_EXECUTION_TIME=300
PHP_MAX_INPUT_TIME=300
PHP_MAX_INPUT_VARS=1000

# ============================================================
# OPcache Configuration
# ============================================================

# Enable OPcache (1 = enabled, 0 = disabled)
PHP_OPCACHE_ENABLE=1

# OPcache memory consumption (MB)
PHP_OPCACHE_MEMORY=128

# Interned strings buffer (MB)
PHP_OPCACHE_STRINGS=8

# Max accelerated files (must be prime number)
PHP_OPCACHE_FILES=4000

# Revalidation frequency (seconds, 0 = always check in dev)
PHP_OPCACHE_REVALIDATE=2

# Validate timestamps (1 = check file changes, 0 = never check)
PHP_OPCACHE_VALIDATE_TIMESTAMPS=1

# ============================================================
# PHP-FPM Configuration
# ============================================================

# Process manager type: static, dynamic, ondemand
PHP_FPM_PM=ondemand

# Maximum number of child processes
PHP_FPM_MAX_CHILDREN=100

# Number of child processes created on startup (dynamic only)
PHP_FPM_START_SERVERS=5

# Minimum number of idle processes (dynamic only)
PHP_FPM_MIN_SPARE_SERVERS=5

# Maximum number of idle processes (dynamic only)
PHP_FPM_MAX_SPARE_SERVERS=10

# Idle timeout for ondemand (seconds with 's' suffix)
PHP_FPM_PROCESS_IDLE_TIMEOUT=10s

# Number of requests each child process should execute before respawning
PHP_FPM_MAX_REQUESTS=1000

# ============================================================
# Database Configuration (MariaDB/MySQL)
# ============================================================

# Database host
DB_HOST=mariadb
# or use: MYSQL_HOST=mariadb

# Database credentials
DB_USER=app
DB_PASSWORD=secret
DB_NAME=app

# or use MySQL-style:
# MYSQL_USER=app
# MYSQL_PASSWORD=secret
# MYSQL_DATABASE=app

# Root password (for initial setup)
MYSQL_ROOT_PASSWORD=root

# ============================================================
# Redis Configuration (Optional)
# ============================================================

REDIS_HOST=redis
REDIS_PORT=6379

# ============================================================
# Sentry Configuration (Optional)
# Requires: composer require sentry/sentry
# ============================================================

# Enable Sentry error tracking
SENTRY_ENABLED=false

# Sentry DSN (get from Sentry project settings)
# SENTRY_DSN=https://key@sentry.example.com/project

# Environment name
SENTRY_ENVIRONMENT=production

# Trace sample rate (0.0 to 1.0)
# 1.0 = 100% of transactions, 0.1 = 10%
SENTRY_TRACE_SAMPLE_RATE=0.1

# Application version for release tracking
APP_VERSION=1.0.0

# Application hostname (defaults to container hostname)
# APP_HOSTNAME=api.example.com

# ============================================================
# Xdebug Configuration (Development only)
# ============================================================

# Xdebug modes: develop, debug, coverage, profile, trace
# Combine with commas: develop,debug,coverage
XDEBUG_MODE=develop,debug,coverage

# IDE connection settings
XDEBUG_CLIENT_HOST=host.docker.internal
XDEBUG_CLIENT_PORT=9003

# Start debugging: yes, no, trigger
XDEBUG_START_WITH_REQUEST=trigger

# IDE key (PHPSTORM, VSCODE, etc.)
XDEBUG_IDEKEY=PHPSTORM

# ============================================================
# Production OPcache Configuration
# ============================================================

# JIT buffer size (production only)
PHP_OPCACHE_JIT_BUFFER=128M

# ============================================================
# Application-Specific Variables
# Add your custom environment variables below
# ============================================================

# Example:
# API_KEY=your-api-key
# FEATURE_FLAG_NEW_UI=true